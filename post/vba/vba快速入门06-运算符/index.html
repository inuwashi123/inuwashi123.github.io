<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>vba快速入门06-运算符 - None - 记录在日本从事IT的所感所想。</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="inuwashi" /><meta name="description" content="运算符 类型 说明 运算符 算术运算符 用于执行数学计算的运算符。 *运算符 ^运算符 /运算符 \运算符 Mod运算符 &#43;运算符 -运算符 比较运算符 用于执行比较的" /><meta name="keywords" content="vba, 宏, 运算符" />






<meta name="generator" content="Hugo 0.57.2 with even 4.0.0" />


<link rel="canonical" href="https://inuwashi123.github.io/post/vba/vba%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A806-%E8%BF%90%E7%AE%97%E7%AC%A6/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.c2a46f00.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="vba快速入门06-运算符" />
<meta property="og:description" content="运算符 类型 说明 运算符 算术运算符 用于执行数学计算的运算符。 *运算符 ^运算符 /运算符 \运算符 Mod运算符 &#43;运算符 -运算符 比较运算符 用于执行比较的" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://inuwashi123.github.io/post/vba/vba%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A806-%E8%BF%90%E7%AE%97%E7%AC%A6/" />
<meta property="article:published_time" content="2019-10-26T09:09:44+09:00" />
<meta property="article:modified_time" content="2019-10-26T09:09:44+09:00" />
<meta itemprop="name" content="vba快速入门06-运算符">
<meta itemprop="description" content="运算符 类型 说明 运算符 算术运算符 用于执行数学计算的运算符。 *运算符 ^运算符 /运算符 \运算符 Mod运算符 &#43;运算符 -运算符 比较运算符 用于执行比较的">


<meta itemprop="datePublished" content="2019-10-26T09:09:44&#43;09:00" />
<meta itemprop="dateModified" content="2019-10-26T09:09:44&#43;09:00" />
<meta itemprop="wordCount" content="5007">



<meta itemprop="keywords" content="excel vba," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="vba快速入门06-运算符"/>
<meta name="twitter:description" content="运算符 类型 说明 运算符 算术运算符 用于执行数学计算的运算符。 *运算符 ^运算符 /运算符 \运算符 Mod运算符 &#43;运算符 -运算符 比较运算符 用于执行比较的"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">None</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">None</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">vba快速入门06-运算符</h1>

      <div class="post-meta">
        <span class="post-time"> 2019-10-26 </span>
        <div class="post-category">
            <a href="/categories/vba/"> vba </a>
            </div>
          <span class="more-meta"> 约 5007 字 </span>
          <span class="more-meta"> 预计阅读 10 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#运算符">运算符</a>
<ul>
<li><a href="#算术运算符">算术运算符</a></li>
<li><a href="#比较运算符">比较运算符</a></li>
<li><a href="#串联运算符">串联运算符</a></li>
<li><a href="#逻辑运算符">逻辑运算符</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
</div>
    <div class="post-content">
      

<h2 id="运算符">运算符</h2>

<table>
<thead>
<tr>
<th>类型</th>
<th>说明</th>
<th>运算符</th>
</tr>
</thead>

<tbody>
<tr>
<td>算术运算符</td>
<td>用于执行数学计算的运算符。</td>
<td>*运算符  ^运算符  /运算符  \运算符  Mod运算符  +运算符  -运算符</td>
</tr>

<tr>
<td>比较运算符</td>
<td>用于执行比较的运算符。</td>
<td>=运算符  Is运算符  Like运算符</td>
</tr>

<tr>
<td>串联运算符</td>
<td>用于组合字符串的运算符。</td>
<td>&amp;运算符  +运算符</td>
</tr>

<tr>
<td>逻辑运算符</td>
<td>用于执行逻辑运算的运算符。</td>
<td>And运算符  Eqv运算符  Imp运算符  Not运算符  Or运算符  Xor运算符</td>
</tr>
</tbody>
</table>

<h3 id="算术运算符">算术运算符</h3>

<table>
<thead>
<tr>
<th>运算符</th>
<th>含义</th>
<th>说明</th>
<th>例子</th>
</tr>
</thead>

<tbody>
<tr>
<td>+</td>
<td>加</td>
<td>加法运算</td>
<td>a = 1 + 2 结果a等于3</td>
</tr>

<tr>
<td>-</td>
<td>减</td>
<td>减法运算</td>
<td>a = 1 - 2 结果a等于-1</td>
</tr>

<tr>
<td>*</td>
<td>乘</td>
<td>乘法运算</td>
<td>a = 2 * 3 结果a等于6</td>
</tr>

<tr>
<td>-</td>
<td>取反</td>
<td>取反运算</td>
<td>a = -2 结果a等于-2</td>
</tr>

<tr>
<td>^</td>
<td>幂</td>
<td>幂运算</td>
<td>a = 2^3 相当于a = 2*2*2 结果a等于8</td>
</tr>

<tr>
<td>/</td>
<td>除</td>
<td>除法运算</td>
<td>a = 10 / 3 结果a等于3.333333333</td>
</tr>

<tr>
<td>\</td>
<td>整除</td>
<td>整除运算</td>
<td>a = 10 / 3 结果a等于3</td>
</tr>

<tr>
<td>Mod</td>
<td>取模</td>
<td>取模运算（余数运算）</td>
<td>a = 10 Mod 3 结果a等于1</td>
</tr>
</tbody>
</table>

<p>加减乘除幂和数学上的意义是一样的，不用多做介绍。着重介绍下取反，整除和取模运算。</p>

<p>取反运算符同减法运算符是一样的，都是-。区别是取反运算是一元运算符，也就是只能单独用于一个数字，不能用于两个以上的数字进行运算。你可以把取反运算符看作是负号就好。</p>

<p>\ 用于将两个数字相除并返回整数类型的结果。这两个数字进行整除之前，先进行四舍五入计算后再整除。</p>

<p>例1，整除</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test1</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">num1</span> <span class="ow">As</span> <span class="kt">Integer</span>
    <span class="k">Dim</span> <span class="n">num2</span> <span class="ow">As</span> <span class="k">Single</span><span class="p">,</span> <span class="n">num3</span> <span class="ow">As</span> <span class="k">Single</span>
    <span class="n">num1</span> <span class="o">=</span> <span class="n">10</span>
    <span class="n">num2</span> <span class="o">=</span> <span class="n">11</span><span class="p">#</span>
    <span class="n">num3</span> <span class="o">=</span> <span class="n">11</span><span class="p">.</span><span class="n">6</span>

    <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">num1</span> <span class="o">/</span> <span class="n">3</span>
    <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">num2</span> <span class="o">/</span> <span class="n">3</span>  <span class="c">&#39;Single类型的小数点后是6位
</span><span class="c"></span>    <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">num3</span> <span class="o">/</span> <span class="n">3</span>  <span class="c">&#39;Single类型的小数点后是6位
</span><span class="c"></span>    <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">num1</span> <span class="o">\</span> <span class="n">3</span>
    <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">num2</span> <span class="o">\</span> <span class="n">3</span>
    <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">num3</span> <span class="o">\</span> <span class="n">3</span>  <span class="c">&#39;结果是4，不是3
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<p>以上程序的运行结果如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-result" data-lang="result"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-result" data-lang="result">3.33333333333333
3.666667
3.866667
3
3
4</code></pre></td></tr></table>
</div>
</div>
<p>Mod，取得两个数字相除后结果的余数。例如，</p>

<p>例2，Mod取模运算</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test2</span><span class="p">()</span>
    <span class="c">&#39; 声明变量MyResult，没有指明类型。默认是Variant类型。
</span><span class="c"></span>    <span class="k">Dim</span> <span class="n">MyResult</span>

    <span class="n">MyResult</span> <span class="o">=</span> <span class="n">10</span> <span class="ow">Mod</span> <span class="n">5</span>      <span class="c">&#39; 结果 0
</span><span class="c"></span>    <span class="n">MyResult</span> <span class="o">=</span> <span class="n">10</span> <span class="ow">Mod</span> <span class="n">3</span>      <span class="c">&#39; 结果 1
</span><span class="c"></span>    <span class="n">MyResult</span> <span class="o">=</span> <span class="n">12</span> <span class="ow">Mod</span> <span class="n">4</span><span class="p">.</span><span class="n">3</span>    <span class="c">&#39; 结果 0
</span><span class="c"></span>    <span class="n">MyResult</span> <span class="o">=</span> <span class="n">12</span><span class="p">.</span><span class="n">6</span> <span class="ow">Mod</span> <span class="n">5</span>    <span class="c">&#39; 结果 3
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<p>算术运算符优先级</p>

<p>数学上我们都学过先乘除后加减，这个先后顺序就是优先级。算术运算符的优先级如下（由大到小排列）：</p>

<table>
<thead>
<tr>
<th>运算符</th>
<th>含义</th>
</tr>
</thead>

<tbody>
<tr>
<td>^</td>
<td>幂</td>
</tr>

<tr>
<td>-</td>
<td>取反</td>
</tr>

<tr>
<td>* 和 /</td>
<td>乘和除</td>
</tr>

<tr>
<td></td>
<td>整除</td>
</tr>

<tr>
<td>Mod</td>
<td>取模</td>
</tr>

<tr>
<td>+ 和 -</td>
<td>加和减</td>
</tr>
</tbody>
</table>

<p>如果想改变优先级，可以加上括号。优先计算括号内的运算。</p>

<p>例3，算术运算优先级</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test3</span><span class="p">()</span>
    <span class="c">&#39; 声明变量MyResult，没有指明类型。默认是Variant类型。
</span><span class="c"></span>    <span class="k">Dim</span> <span class="n">MyResult</span>

    <span class="n">MyResult</span> <span class="o">=</span> <span class="n">2</span> <span class="o">-</span> <span class="n">2</span> <span class="o">*</span> <span class="n">3</span>         <span class="c">&#39; 先计算2 * 3得到6，然后再计算2 - 6，最终结果 -4
</span><span class="c"></span>    <span class="n">MyResult</span> <span class="o">=</span> <span class="n">2</span> <span class="o">-</span> <span class="n">2</span> <span class="o">*</span> <span class="n">3</span> <span class="o">^</span> <span class="n">2</span>     <span class="c">&#39; 先计算3 ^ 2得到9，然后再计算2 * 9得到18，然后再计算2 - 18，最终结果 -16
</span><span class="c"></span>    <span class="n">MyResult</span> <span class="o">=</span> <span class="n">2</span> <span class="o">+</span> <span class="n">2</span> <span class="o">*</span> <span class="n">3</span> <span class="ow">Mod</span> <span class="n">2</span>   <span class="c">&#39; 先计算2 * 3得到6，然后再计算6 Mod 2得到0，然后再计算2 + 0，最终结果 2
</span><span class="c"></span>    <span class="n">MyResult</span> <span class="o">=</span> <span class="p">(</span><span class="n">2</span> <span class="o">-</span> <span class="n">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">3</span> <span class="ow">Mod</span> <span class="n">2</span> <span class="c">&#39; 先计算2 - 3得到0，然后再计算0 * 3 得到0，然后再计算 0 Mod 2，最终结果 0
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="比较运算符">比较运算符</h3>

<table>
<thead>
<tr>
<th>运算符</th>
<th>含义</th>
<th>例子</th>
</tr>
</thead>

<tbody>
<tr>
<td>=</td>
<td>赋值运算</td>
<td>a = 3 结果a等于3</td>
</tr>

<tr>
<td>Is</td>
<td>判断运算</td>
<td>a = object1 Is object2 判断object1是否是object2，返回True或False。</td>
</tr>

<tr>
<td>Like</td>
<td>匹配运算</td>
<td>a = &ldquo;aBBBa&rdquo; Like &ldquo;a*a&rdquo; 模式匹配，返回True。</td>
</tr>

<tr>
<td>&lt;</td>
<td>小于运算</td>
<td>a = 3 &lt; 3 结果a等于False</td>
</tr>

<tr>
<td>&lt;=</td>
<td>小于等于运算</td>
<td>a = 3 &lt;= 3 结果a等于True</td>
</tr>

<tr>
<td>&gt;</td>
<td>大于运算</td>
<td>a = 3 &gt; 3 结果a等于False</td>
</tr>

<tr>
<td>&gt;=</td>
<td>大于等于运算</td>
<td>a = 3 &gt;= 3 结果a等于True</td>
</tr>

<tr>
<td>=</td>
<td>等于运算</td>
<td>a = (3 = 3) 结果a等于True</td>
</tr>

<tr>
<td>&lt;&gt;</td>
<td>不等于运算</td>
<td>a = 3 &lt;&gt; 3 结果a等于False</td>
</tr>
</tbody>
</table>

<p>赋值运算用于给变量赋值。到现在为止，我们见的最多的就是赋值运算符。</p>

<p>Is运算主要是用来判断两个对象，如果是同一个对象返回True，不是同一个对象返回False。关于对象的概念在以后的课程里我们会介绍。在Excel里面常见的对象是单元格Cell对象，Sheet对象，Workbook对象等，下面我们以单元格对象为例较少下Is的用法。</p>

<p>例4，Is运算符，判断是不是同一个单元格。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test4</span><span class="p">()</span>
    <span class="c">&#39;声明单元格对象cellA1，cellA2
</span><span class="c"></span>    <span class="k">Dim</span> <span class="n">cellA1</span> <span class="ow">As</span> <span class="n">Range</span>
    <span class="k">Dim</span> <span class="n">cellA2</span> <span class="ow">As</span> <span class="n">Range</span>

    <span class="c">&#39;单元格对象cellA1，cellA2的初始化，对象的初始用set
</span><span class="c"></span>    <span class="k">Set</span> <span class="n">cellA1</span> <span class="o">=</span> <span class="n">Range</span><span class="p">(</span><span class="s">&#34;A1&#34;</span><span class="p">)</span>
    <span class="k">Set</span> <span class="n">cellA2</span> <span class="o">=</span> <span class="n">Range</span><span class="p">(</span><span class="s">&#34;A2&#34;</span><span class="p">)</span>

    <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">cellA1</span> <span class="ow">Is</span> <span class="n">cellA2</span> <span class="c">&#39; 结果 False
</span><span class="c"></span>    <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">cellA1</span> <span class="ow">Is</span> <span class="n">cellA1</span> <span class="c">&#39; 结果 True
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<p>Like运算用于比较两个字符串。Like用法如下：
<code>result = string Like pattern</code></p>

<p>如果string匹配上了pattern，那么result是True，没有匹配上，result是False。如果string和pattern都是Null的话，result也是Null。</p>

<p>Like运算符的行为取决于<code>Option Compare</code>语句。<code>Option Compare</code>语句有<code>Option Compare Binary</code>和<code>Option Compare Text</code>两种。默认方法为<code>Option Compare Binary</code>。</p>

<p><code>Option Compare Binary</code>根据派生自字符的内部二进制表示形式的排序顺序生成字符串比较。 排序顺序由代码页确定。
以下示例中显示了典型的二进制排序顺序：
A &lt; B &lt; E &lt; Z &lt; a &lt; b &lt; e &lt; z &lt; À &lt; Ê &lt; Ø &lt; à &lt; ê &lt; ø</p>

<p><code>Option Compare Text</code>根据由系统的区域设置确定的不区分大小写的文本排序顺序生成字符串比较。 当使用 Option Compare Text 为相同的字符排序时，将生成以下文本排序顺序：
(A=a) &lt; (À=à) &lt; (B=b) &lt; (E=e) &lt; (Ê=ê) &lt; (Z=z) &lt; (Ø=ø)</p>

<p>内置模式匹配为字符串比较提供了一个功能多样的工具。 利用模式匹配功能，您可以将通配符、字符列表或字符范围任意组合使用来匹配字符串。 下表显示了 pattern 中允许使用的字符以及它们的匹配项：</p>

<table>
<thead>
<tr>
<th>模式中的字符</th>
<th>字符串中的匹配项</th>
</tr>
</thead>

<tbody>
<tr>
<td>?</td>
<td>任意单个字符。</td>
</tr>

<tr>
<td>*</td>
<td>零个或多个字符。</td>
</tr>

<tr>
<td>#</td>
<td>任何单个数字 (0-9)。</td>
</tr>

<tr>
<td>[ charlist ]</td>
<td>charlist内的任意单个字符。</td>
</tr>

<tr>
<td>[ !charlist ]</td>
<td>charlist外的任意单个字符。</td>
</tr>
</tbody>
</table>

<p>例5，Like运算符</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test5</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">MyCheck</span>
    <span class="n">MyCheck</span> <span class="o">=</span> <span class="s">&#34;aBBBa&#34;</span> <span class="ow">Like</span> <span class="s">&#34;a*a&#34;</span>     <span class="c">&#39; 结果True
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="s">&#34;F&#34;</span> <span class="ow">Like</span> <span class="s">&#34;[A-Z]&#34;</span>       <span class="c">&#39; 结果 True
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="s">&#34;F&#34;</span> <span class="ow">Like</span> <span class="s">&#34;[!A-Z]&#34;</span>      <span class="c">&#39; 结果 False
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="s">&#34;a2a&#34;</span> <span class="ow">Like</span> <span class="s">&#34;a#a&#34;</span>       <span class="c">&#39; 结果 True
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="s">&#34;aM5b&#34;</span> <span class="ow">Like</span> <span class="s">&#34;a [L-P]#[!c-e]&#34;</span>  <span class="c">&#39; 结果 True
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="s">&#34;BAT123khg&#34;</span> <span class="ow">Like</span> <span class="s">&#34;B?T*&#34;</span>    <span class="c">&#39; 结果 True
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="s">&#34;CAT123khg&#34;</span> <span class="ow">Like</span> <span class="s">&#34;B?T*&#34;</span>    <span class="c">&#39; 结果 False
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="s">&#34;ab&#34;</span> <span class="ow">Like</span> <span class="s">&#34;a*b&#34;</span>            <span class="c">&#39; 结果 True
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="s">&#34;a*b&#34;</span> <span class="ow">Like</span> <span class="s">&#34;a [*]b&#34;</span>        <span class="c">&#39; 结果 False
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="s">&#34;axxxxxb&#34;</span> <span class="ow">Like</span> <span class="s">&#34;a [*]b&#34;</span>    <span class="c">&#39; 结果 False
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="s">&#34;a [xyz&#34;</span> <span class="ow">Like</span> <span class="s">&#34;a [[]*&#34;</span>     <span class="c">&#39; 结果 True
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="s">&#34;a [xyz&#34;</span> <span class="ow">Like</span> <span class="s">&#34;a [*&#34;</span>       <span class="c">&#39; Throws Error 93 (invalid pattern string)
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<p>比较运算符的优先级都相同；也就是说，它们按照显示的顺序从左向右进行计算。</p>

<h3 id="串联运算符">串联运算符</h3>

<table>
<thead>
<tr>
<th>运算符</th>
<th>含义</th>
<th>例子</th>
</tr>
</thead>

<tbody>
<tr>
<td>&amp;</td>
<td>字符串连接运算</td>
<td>a = &ldquo;hello&rdquo; &amp; &ldquo; World&rdquo; 结果a等于&rdquo;hello World&rdquo;</td>
</tr>

<tr>
<td>+</td>
<td>字符串连接运算</td>
<td>a = &ldquo;hello&rdquo; + &ldquo; World&rdquo; 结果a等于&rdquo;hello World&rdquo;</td>
</tr>
</tbody>
</table>

<p>&amp;用于强制连接两个表达式的字符串。<br />
<code>result = expression1 &amp; expression2</code></p>

<p>如果expression1或expression2不是String类型的话，会被转化为String类型再进行连接。
如果expression1和expression2都是Null，那么result也是Null。如果只有一个表达式是Null的话，那么这个表达式被转化为空字符串&rdquo;&ldquo;再进行连接。</p>

<p>例6，&amp;运算符</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test6</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">MyStr</span>

    <span class="n">MyStr</span> <span class="o">=</span> <span class="s">&#34;Hello&#34;</span> <span class="o">&amp;</span> <span class="s">&#34; World&#34;</span>          <span class="c">&#39; 结果 &#34;Hello World&#34;
</span><span class="c"></span>    <span class="n">MyStr</span> <span class="o">=</span> <span class="s">&#34;Check &#34;</span> <span class="o">&amp;</span> <span class="n">123</span> <span class="o">&amp;</span> <span class="s">&#34; Check&#34;</span>   <span class="c">&#39; 结果 &#34;Check 123 Check&#34;
</span><span class="c"></span>    <span class="n">MyStr</span> <span class="o">=</span> <span class="s">&#34;Hello&#34;</span> <span class="o">&amp;</span> <span class="n">Null</span>              <span class="c">&#39; 结果 &#34;Hello&#34;
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<p>+既是加法运算符也是字符连接运算符，当+的左右两侧都是数字的时候，+是加法运算。两侧都是String类型的时候是字符连接运算。</p>

<p>例7，+运算符</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test7</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">MyStr</span>

    <span class="n">MyStr</span> <span class="o">=</span> <span class="s">&#34;Hello&#34;</span> <span class="o">+</span> <span class="s">&#34; World&#34;</span>          <span class="c">&#39; 结果 &#34;Hello World&#34;
</span><span class="c"></span>    <span class="n">MyStr</span> <span class="o">=</span> <span class="n">123</span> <span class="o">+</span> <span class="n">100</span>              <span class="c">&#39; 结果 223
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<p>+两侧的类型不一致，会引发错误。当类型不一致时，请用类型转换函数进行转化后再使用+。</p>

<p>例8，+运算符</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test8</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">MyStr</span>
    <span class="n">MyStr</span> <span class="o">=</span> <span class="s">&#34;Hello &#34;</span> <span class="o">+</span> <span class="n">123</span> <span class="o">+</span> <span class="s">&#34; World&#34;</span>  <span class="c">&#39; 类型错误。
</span><span class="c"></span>    <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">MyStr</span>
<span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<p>运行Test8过程的后的错误如下：</p>

<p><img src="/images/vba/005-1-TypeError1.PNG" alt="类型转换错误" title="类型转换错误" /></p>

<p>把123强制转化为String类型，就不会报错了，如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test8</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">MyStr</span>
    <span class="n">MyStr</span> <span class="o">=</span> <span class="s">&#34;Hello &#34;</span> <span class="o">+</span>  <span class="k">CStr</span><span class="p">(</span><span class="n">123</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#34; World&#34;</span>
    <span class="n">Debug</span><span class="p">.</span><span class="n">Print</span> <span class="n">MyStr</span>  <span class="c">&#39; 结果 Hello 123 World
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="逻辑运算符">逻辑运算符</h3>

<table>
<thead>
<tr>
<th>运算符</th>
<th>含义</th>
<th>例子</th>
</tr>
</thead>

<tbody>
<tr>
<td>And</td>
<td>逻辑与运算</td>
<td>a = True And False 结果a等于False</td>
</tr>

<tr>
<td>Or</td>
<td>逻辑或运算</td>
<td>a = &ldquo;hello&rdquo; &amp; &ldquo; World&rdquo; 结果a等于&rdquo;hello World&rdquo;</td>
</tr>

<tr>
<td>Not</td>
<td>逻辑非运算</td>
<td>a = &ldquo;hello&rdquo; &amp; &ldquo; World&rdquo; 结果a等于&rdquo;hello World&rdquo;</td>
</tr>

<tr>
<td>Xor</td>
<td>逻辑异或运算</td>
<td>a = &ldquo;hello&rdquo; &amp; &ldquo; World&rdquo; 结果a等于&rdquo;hello World&rdquo;</td>
</tr>

<tr>
<td>Eqv</td>
<td>逻辑等价运算</td>
<td>a =  True Eqv False 结果a等于False</td>
</tr>

<tr>
<td>Imp</td>
<td>逻辑隐含运算</td>
<td>a = &ldquo;hello&rdquo; &amp; &ldquo; World&rdquo; 结果a等于&rdquo;hello World&rdquo;</td>
</tr>
</tbody>
</table>

<p>And 逻辑与运算符,用于对两个表达式执行逻辑与运算。<br />
<code>result = expression1 And expression2</code></p>

<p>如果expression1和expression2都是True，那么result是True。如果其中有一个表达式是False，那么result是False。如下表所示：</p>

<table>
<thead>
<tr>
<th>If expression1 is</th>
<th>And expression2 is</th>
<th>The result is</th>
</tr>
</thead>

<tbody>
<tr>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>

<tr>
<td>True</td>
<td>Null</td>
<td>Null</td>
</tr>

<tr>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>

<tr>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>

<tr>
<td>False</td>
<td>Null</td>
<td>False</td>
</tr>

<tr>
<td>Null</td>
<td>True</td>
<td>Null</td>
</tr>

<tr>
<td>Null</td>
<td>False</td>
<td>False</td>
</tr>

<tr>
<td>Null</td>
<td>Null</td>
<td>Null</td>
</tr>
</tbody>
</table>

<p>如果expression1和expression2都是数值表达式，那么And会对表达式相同位置的位进行按位比较。如下表所示：<br />
If bit in expression1 is | And bit in expression2 is | The result is
&mdash;|&mdash;|&mdash;
0 | 0 | 0
0 | 1 | 0
1 | 0 | 0
1 | 1 | 1</p>

<p>例9，And运算符</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test9</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">MyCheck</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">10</span><span class="p">:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">8</span><span class="p">:</span> <span class="n">C</span> <span class="o">=</span> <span class="n">6</span><span class="p">:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">Null</span>    <span class="c">&#39; 初始化变量
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="n">B</span> <span class="ow">And</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">C</span>         <span class="c">&#39; 结果 True.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">A</span> <span class="ow">And</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">C</span>         <span class="c">&#39; 结果 False.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="n">B</span> <span class="ow">And</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">D</span>         <span class="c">&#39; 结果 Null.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">A</span> <span class="ow">And</span> <span class="n">B</span>                 <span class="c">&#39; 结果 8 (按位比较).
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<p>Or 逻辑或运算,用于对两个表达式执行逻辑或运算。<br />
<code>result = expression1 Or expression2</code></p>

<p>如果expression1或者expression2都是True，那么result是True，否则是False。如下表所示：</p>

<table>
<thead>
<tr>
<th>If expression1 is</th>
<th>And expression2 is</th>
<th>The result is</th>
</tr>
</thead>

<tbody>
<tr>
<td>True</td>
<td>True</td>
<td>True</td>
</tr>

<tr>
<td>True</td>
<td>False</td>
<td>True</td>
</tr>

<tr>
<td>True</td>
<td>NULL</td>
<td>True</td>
</tr>

<tr>
<td>False</td>
<td>True</td>
<td>True</td>
</tr>

<tr>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>

<tr>
<td>False</td>
<td>NULL</td>
<td>NULL</td>
</tr>

<tr>
<td>NULL</td>
<td>True</td>
<td>True</td>
</tr>

<tr>
<td>NULL</td>
<td>False</td>
<td>NULL</td>
</tr>

<tr>
<td>NULL</td>
<td>NULL</td>
<td>NULL</td>
</tr>
</tbody>
</table>

<p>如果expression1和expression2都是数值表达式，那么Or会对表达式相同位置的位进行按位比较。如下表所示：</p>

<table>
<thead>
<tr>
<th>If bit in expression1 is</th>
<th>And bit in expression2 is</th>
<th>The result is</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>

<tr>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>

<tr>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>

<tr>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>例10，Or运算符</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test10</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">MyCheck</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">10</span><span class="p">:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">8</span><span class="p">:</span> <span class="n">C</span> <span class="o">=</span> <span class="n">6</span><span class="p">:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">Null</span>    <span class="c">&#39; 初始化变量
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="n">B</span> <span class="ow">Or</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">C</span>    <span class="c">&#39; 结果 True.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">A</span> <span class="ow">Or</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">C</span>    <span class="c">&#39; 结果 True.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="n">B</span> <span class="ow">Or</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">D</span>    <span class="c">&#39; 结果 True.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">D</span> <span class="ow">Or</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">A</span>    <span class="c">&#39; 结果 Null.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">A</span> <span class="ow">Or</span> <span class="n">B</span>            <span class="c">&#39; 结果 10 (按位比较).
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<p>Not 逻辑非运算,用于对表达式执行逻辑非运算。<br />
<code>result = Not expression</code></p>

<p>结果如下表所示：<br />
If expression is | The result is
&mdash;|&mdash;
True | False
False | True
NULL | NULL</p>

<p>如果expression都是数值表达式，那么Or会对表达式相同位置的位进行按位比较。如下表所示：</p>

<table>
<thead>
<tr>
<th>If bit in expression is</th>
<th>The result is</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>1</td>
</tr>

<tr>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>例11，Not运算符</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test11</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">MyCheck</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">10</span><span class="p">:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">8</span><span class="p">:</span> <span class="n">C</span> <span class="o">=</span> <span class="n">6</span><span class="p">:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">Null</span>    <span class="c">&#39; 初始化变量.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="k">Not</span> <span class="p">(</span><span class="n">A</span> <span class="o">&gt;</span> <span class="n">B</span><span class="p">)</span>   <span class="c">&#39; 结果 False.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="k">Not</span> <span class="p">(</span><span class="n">B</span> <span class="o">&gt;</span> <span class="n">A</span><span class="p">)</span>   <span class="c">&#39; 结果 True.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="k">Not</span> <span class="p">(</span><span class="n">C</span> <span class="o">&gt;</span> <span class="n">D</span><span class="p">)</span>   <span class="c">&#39; 结果 Null.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="k">Not</span> <span class="n">A</span>    <span class="c">&#39; 结果 -11  (按位比较).
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<p>Xor 逻辑异或运算,用于对两个表达式执行逻辑异或运算。
<code>[ result = ] expression1 Xor expression2</code></p>

<p>如果有且只有一个表达式的值为True，则result为True。 但是，只要有一个表达式为Null，则result也为Null。如下表所示：</p>

<table>
<thead>
<tr>
<th>If expression1 is</th>
<th>And expression2 is</th>
<th>The result is</th>
</tr>
</thead>

<tbody>
<tr>
<td>True</td>
<td>True</td>
<td>False</td>
</tr>

<tr>
<td>True</td>
<td>False</td>
<td>True</td>
</tr>

<tr>
<td>False</td>
<td>True</td>
<td>True</td>
</tr>

<tr>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>如果expression1和expression2都是数值表达式，那么Xor会对表达式相同位置的位进行按位比较。如下表所示：</p>

<table>
<thead>
<tr>
<th>If bit in expression1 is</th>
<th>And bit in expression2 is</th>
<th>The result is</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>

<tr>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>

<tr>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>

<tr>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>例12，Xor运算符</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test12</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">MyCheck</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">10</span><span class="p">:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">8</span><span class="p">:</span> <span class="n">C</span> <span class="o">=</span> <span class="n">6</span><span class="p">:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">Null</span>    <span class="c">&#39; 初始化变量
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="n">B</span> <span class="ow">Xor</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">C</span>    <span class="c">&#39; 结果 False.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">A</span> <span class="ow">Xor</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">C</span>    <span class="c">&#39; 结果 True.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">A</span> <span class="ow">Xor</span> <span class="n">C</span> <span class="o">&gt;</span> <span class="n">B</span>    <span class="c">&#39; 结果 False.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">D</span> <span class="ow">Xor</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="n">B</span>    <span class="c">&#39; 结果 Null.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">A</span> <span class="ow">Xor</span> <span class="n">B</span>    <span class="c">&#39; 结果 2  (按位比较).
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<p>Eqv 逻辑等价运算符,用于对两个表达式执行逻辑等价运算。<br />
<code>result = expression1 Eqv expression2</code></p>

<p>如果expression1或expression2是Null，那么result是Null。如果expression1和expression2都不是Null，并且expression1和expression2的表达式结果是一样的，那么result是True，否则是False。如下表所示：</p>

<table>
<thead>
<tr>
<th>If expression1 is</th>
<th>And expression2 is</th>
<th>The result is</th>
</tr>
</thead>

<tbody>
<tr>
<td>True</td>
<td>True</td>
<td>True</td>
</tr>

<tr>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>

<tr>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>

<tr>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
</tbody>
</table>

<p>如果expression1和expression2都是数值表达式，那么And会对表达式相同位置的位进行按位比较。如下表所示：</p>

<table>
<thead>
<tr>
<th>If bit in expression1 is</th>
<th>And bit in expression2 is</th>
<th>The result is</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>

<tr>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>

<tr>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>

<tr>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>例13，Eqv运算符</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test13</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">MyCheck</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">10</span><span class="p">:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">8</span><span class="p">:</span> <span class="n">C</span> <span class="o">=</span> <span class="n">6</span><span class="p">:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">Null</span>    <span class="c">&#39; 初始化变量
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="n">B</span> <span class="n">Eqv</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">C</span>         <span class="c">&#39; 结果 True.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">A</span> <span class="n">Eqv</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">C</span>         <span class="c">&#39; 结果 False.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="n">B</span> <span class="n">Eqv</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">D</span>         <span class="c">&#39; 结果 Null.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">A</span> <span class="n">Eqv</span> <span class="n">B</span>                 <span class="c">&#39; 结果 -3 (按位比较).
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<p>Imp 逻辑隐含运算,用于对两个表达式执行逻辑隐含。<br />
<code>result = expression1 Imp expression2</code></p>

<p>结果，如下表所示：</p>

<table>
<thead>
<tr>
<th>If expression1 is</th>
<th>And expression2 is</th>
<th>The result is</th>
</tr>
</thead>

<tbody>
<tr>
<td>True</td>
<td>True</td>
<td>True</td>
</tr>

<tr>
<td>True</td>
<td>False</td>
<td>False</td>
</tr>

<tr>
<td>True</td>
<td>Null</td>
<td>Null</td>
</tr>

<tr>
<td>False</td>
<td>True</td>
<td>True</td>
</tr>

<tr>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>

<tr>
<td>False</td>
<td>Null</td>
<td>True</td>
</tr>

<tr>
<td>Null</td>
<td>True</td>
<td>True</td>
</tr>

<tr>
<td>Null</td>
<td>False</td>
<td>Null</td>
</tr>

<tr>
<td>Null</td>
<td>Null</td>
<td>Null</td>
</tr>
</tbody>
</table>

<p>如果expression1和expression2都是数值表达式，那么Imp会对表达式相同位置的位进行按位比较。如下表所示：</p>

<table>
<thead>
<tr>
<th>If bit in expression1 is</th>
<th>And bit in expression2 is</th>
<th>The result is</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>

<tr>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>

<tr>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>

<tr>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>例14，Imp运算符</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-vb" data-lang="vb"><span class="k">Sub</span> <span class="nf">Test12</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">MyCheck</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">10</span><span class="p">:</span> <span class="n">B</span> <span class="o">=</span> <span class="n">8</span><span class="p">:</span> <span class="n">C</span> <span class="o">=</span> <span class="n">6</span><span class="p">:</span> <span class="n">D</span> <span class="o">=</span> <span class="n">Null</span>    <span class="c">&#39; 初始化变量
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="n">B</span> <span class="n">Imp</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">C</span>    <span class="c">&#39; 结果 True.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">A</span> <span class="o">&gt;</span> <span class="n">B</span> <span class="n">Imp</span> <span class="n">C</span> <span class="o">&gt;</span> <span class="n">B</span>    <span class="c">&#39; 结果 False.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">A</span> <span class="n">Imp</span> <span class="n">C</span> <span class="o">&gt;</span> <span class="n">B</span>    <span class="c">&#39; 结果 True.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">A</span> <span class="n">Imp</span> <span class="n">C</span> <span class="o">&gt;</span> <span class="n">D</span>    <span class="c">&#39; 结果 True.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">C</span> <span class="o">&gt;</span> <span class="n">D</span> <span class="n">Imp</span> <span class="n">B</span> <span class="o">&gt;</span> <span class="n">A</span>    <span class="c">&#39; 结果 Null.
</span><span class="c"></span>    <span class="n">MyCheck</span> <span class="o">=</span> <span class="n">B</span> <span class="n">Imp</span> <span class="n">A</span>    <span class="c">&#39; 结果 -1 (bitwise comparison).
</span><span class="c"></span><span class="k">End</span> <span class="k">Sub</span></code></pre></td></tr></table>
</div>
</div>
<hr />

<p>参考资料：
<a href="https://docs.microsoft.com/zh-cn/office/vba/language/reference/user-interface-help/operator-summary">https://docs.microsoft.com/zh-cn/office/vba/language/reference/user-interface-help/operator-summary</a></p>

<p>转载请注明本网址。</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/excel-vba/">excel vba</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/vba/vba%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A807-%E6%95%B0%E7%BB%84/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">vba快速入门07-数组</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        <a class="next" href="/post/python/python%E6%95%99%E7%A8%8B042-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B-%E5%85%83%E7%B1%BB/">
            <span class="next-text nav-default">Python教程042 面向对象编程 元类</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        
  
  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="https://github.com/inuwashi123" class="iconfont icon-github" title="github"></a>
  <a href="https://inuwashi123.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2019
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">inuwashi</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>
<script type="text/javascript" src="/dist/even.26188efa.min.js"></script>








</body>
</html>
